{% extends 'base_generic.html' %}

{% block content %}
<style>
    #chat-container {
        border: 1px solid #ccc;
        padding: 15px;
        flex-grow: 1; /* Allow chat container to take up available space */
        overflow-y: scroll;
        background-color: #fff; /* White background for the chat area */
        border-radius: 5px; /* Rounded corners */
    }

    #chat-container p {
        margin: 5px 0; /* Space between messages */
    }

    .alert {
        margin-top: 15px; /* Space above bot responses */
    }

    .btn-primary {
        background-color: #f5896f; /* Custom primary color */
        border-color: #f5896f; /* Same color for border */
    }

    .btn-primary:hover {
        background-color: #b8490e; /* Darker color on hover */
        border-color: #b8490e; /* Match border color on hover */
    }

    /* Additional styling for the input field */
    .form-control {
        border: 1px solid #ced4da; /* Border color for input */
        border-radius: 4px; /* Rounded corners */
    }

    .form-control:focus {
        border-color: #80bdff; /* Focus border color */
        box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25); /* Focus shadow */
    }

    .chat-form-container {
        margin-top: 10px; /* Space above the input field */
    }
</style>

<div class="container">
    <h2>Talk to BeeSafe</h2>
    
    <!-- Chat Display Section -->
    <div id="chat-container" class="mb-3">
        {% if chat_history %}
            {% for message in chat_history %}
                <p><strong>{{ message.user }}:</strong> {{ message.text }}</p>
            {% endfor %}
        {% else %}
            <p>No conversation yet. Start chatting below!</p>
        {% endif %}
    </div>
    
    <!-- Chat Form Section -->
    <div class="chat-form-container">
        <form id="chat-form" method="post">
            {% csrf_token %}
            <div class="mb-3">
                <label for="user_message" class="form-label">Your Message:</label>
                <input type="text" id="user_message" name="user_message" class="form-control" placeholder="Enter your preferences" required>
            </div>
            <button type="submit" class="btn btn-primary">Send</button>
        </form>
    </div>
</div>

<!-- Optional: JavaScript to scroll to the bottom of the chat on new messages -->
<script>
    const chatContainer = document.getElementById('chat-container');
    chatContainer.scrollTop = chatContainer.scrollHeight;  // Scroll to bottom on load
</script>

{% endblock %}
